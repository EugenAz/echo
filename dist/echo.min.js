/*! echo-js-extended v1.7.4 | (c) 2015 @toddmotto | https://github.com/toddmotto/echo */
!function(t,e){"function"==typeof define&&define.amd?define(function(){return e(t)}):"object"==typeof exports?module.exports=e:t.echo=e(t)}(this,function(t){"use strict";function e(){var t;i=setInterval(function(){for(var e in m)t=new Image,t.onload=o.bind(t,e),t.src=e},1500)}function n(t,e){e.src=t,l||(e.removeAttribute("data-echo"),e.removeAttribute("data-echo-retina"),e.removeAttribute("data-echo-mob"),e.removeAttribute("data-echo-mob-retina")),s(e,"load")}function o(t,e){var o;"IMG"===e.tagName?n(t,e):(o=m[t],o.forEach(function(e){n(t,e)}),delete m[t],Object.keys(m).length||clearInterval(i),o=null)}function r(t,n){m[t]=m[t]||[],~m[t].indexOf(n)||m[t].push(n),i||e()}var i,c,a,u,d,l,f,h={},m={},s=function(){},b=function(t){return null===t.offsetParent},v=function(t,e){if(b(t))return!1;var n=t.getBoundingClientRect();return n.right>=e.l&&n.bottom>=e.t&&n.left<=e.r&&n.top<=e.b},g=function(){var e=t.innerWidth||document.documentElement.clientWidth;return f>e},p=function(){return window.devicePixelRatio>1},E=function(){return g()?"-mob":""},A=function(){return p()?"-retina":""},I=function(){(d||!a)&&(clearTimeout(a),a=setTimeout(function(){h.render(),a=null},u))},L=function(t){var e="data-echo"+E()+A();return t.getAttribute(e)?t.getAttribute(e):t.getAttribute("data-echo")};return h.init=function(e){e=e||{};var n=e.offset||0,o=e.offsetVertical||n,r=e.offsetHorizontal||n,i=function(t,e){return parseInt(t||e,10)};c={t:i(e.offsetTop,o),b:i(e.offsetBottom,o),l:i(e.offsetLeft,r),r:i(e.offsetRight,r)},u=i(e.throttle,250),d=e.debounce!==!1,f=e.mobileMQBreakpoint||768,l=!!e.unload,s=e.callback||s,h.render(),document.addEventListener?(t.addEventListener("scroll",I,!1),t.addEventListener("load",I,!1)):(t.attachEvent("onscroll",I),t.attachEvent("onload",I))},h.render=function(){for(var e,n,i,a=document.querySelectorAll("img[data-echo], [data-echo-retina], [data-echo-mob], [data-echo-mob-retina]"),u=a.length,d={l:0-c.l,t:0-c.t,b:(t.innerHeight||document.documentElement.clientHeight)+c.b,r:(t.innerWidth||document.documentElement.clientWidth)+c.r},f=0;u>f;f++)n=a[f],v(n,d)?(l&&n.setAttribute("data-echo-placeholder",n.src),e=L(n),i=new Image,i.onerror=r.bind(i,e,n),i.onload=o.bind(i,e,n),i.src=e):l&&(e=n.getAttribute("data-echo-placeholder"))&&(n.src=e,n.removeAttribute("data-echo-placeholder"),s(n,"unload"));u||h.detach()},h.detach=function(){document.removeEventListener?t.removeEventListener("scroll",I):t.detachEvent("onscroll",I),clearTimeout(a)},h});